<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Metascripts / Cloud Scripts | immy.bot</title>
    <meta name="description" content="A documentation suite for all things ImmyBot">
    <link rel="preload stylesheet" href="/assets/style.8969d4a5.css" as="style">
    
    <script type="module" src="/assets/app.40223181.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.2ed14f66.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/framework.392dd896.js">
    <link rel="modulepreload" href="/assets/chunks/theme.e2eedf84.js">
    <link rel="modulepreload" href="/assets/chunks/c4Diagram-c0b17d02.1d06aec7.js">
    <link rel="modulepreload" href="/assets/chunks/flowDiagram-d6f8fe3a.16492242.js">
    <link rel="modulepreload" href="/assets/chunks/flowDiagram-v2-58f49b84.d7117976.js">
    <link rel="modulepreload" href="/assets/chunks/erDiagram-dedf2781.e765dbc7.js">
    <link rel="modulepreload" href="/assets/chunks/gitGraphDiagram-e0ffc2d1.360b2500.js">
    <link rel="modulepreload" href="/assets/chunks/ganttDiagram-088dbd90.102a66cc.js">
    <link rel="modulepreload" href="/assets/chunks/infoDiagram-64895a6e.b0edf630.js">
    <link rel="modulepreload" href="/assets/chunks/pieDiagram-3fca7ce7.33c2ed10.js">
    <link rel="modulepreload" href="/assets/chunks/quadrantDiagram-0ca4be02.1a5cdbee.js">
    <link rel="modulepreload" href="/assets/chunks/requirementDiagram-e13af0f0.bb760a07.js">
    <link rel="modulepreload" href="/assets/chunks/sequenceDiagram-84aa38e3.05e7c819.js">
    <link rel="modulepreload" href="/assets/chunks/classDiagram-a8cc8886.c4e9fd4f.js">
    <link rel="modulepreload" href="/assets/chunks/classDiagram-v2-802a48d3.c551589a.js">
    <link rel="modulepreload" href="/assets/chunks/stateDiagram-9a586ac6.a8f33278.js">
    <link rel="modulepreload" href="/assets/chunks/stateDiagram-v2-96f2b9df.bda11d56.js">
    <link rel="modulepreload" href="/assets/chunks/journeyDiagram-adaa34f8.5a20f2de.js">
    <link rel="modulepreload" href="/assets/chunks/flowchart-elk-definition-56584a6c.245ccd90.js">
    <link rel="modulepreload" href="/assets/chunks/timeline-definition-1a90b03d.42edacec.js">
    <link rel="modulepreload" href="/assets/chunks/mindmap-definition-57868176.243ab20f.js">
    <link rel="modulepreload" href="/assets/chunks/sankeyDiagram-a7f8e230.f971402b.js">
    <link rel="modulepreload" href="/assets/chunks/virtual_mermaid-config.ade1a5ba.js">
    <link rel="modulepreload" href="/assets/immy-commands.md.3f95c339.lean.js">
    <link rel="icon" href="/favicon.ico">
    <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-4064354f><!--[--><!--]--><!--[--><span tabindex="-1" data-v-c8291ffa></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-c8291ffa> Skip to content </a><!--]--><!----><header class="VPNav" data-v-4064354f data-v-5bdc5df3><div class="VPNavBar has-sidebar" data-v-5bdc5df3 data-v-f1abbc6e><div class="container" data-v-f1abbc6e><div class="title" data-v-f1abbc6e><div class="VPNavBarTitle has-sidebar" data-v-f1abbc6e data-v-2973dbb4><a class="title" href="/" data-v-2973dbb4><!--[--><!--]--><!--[--><img class="VPImage logo" src="/immybot-glasses.png" alt data-v-ab19afbb><!--]--><!--[-->immy.bot<!--]--><!--[--><!--]--></a></div></div><div class="content" data-v-f1abbc6e><div class="curtain" data-v-f1abbc6e></div><div class="content-body" data-v-f1abbc6e><!--[--><!--]--><div class="VPNavBarSearch search" data-v-f1abbc6e><!--[--><!----><div id="docsearch"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg class="DocSearch-Search-Icon" width="20" height="20" viewBox="0 0 20 20" aria-label="search icon"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><!----><!----><div class="VPNavBarAppearance appearance" data-v-f1abbc6e data-v-5e9f0637><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-5e9f0637 data-v-3329432d data-v-1c29e291><span class="check" data-v-1c29e291><span class="icon" data-v-1c29e291><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-3329432d><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-3329432d><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-f1abbc6e data-v-ef6192dc data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/immense/immybot-documentation" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-16cf740a><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-f1abbc6e data-v-c8c2ae4b data-v-aa8de344><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-aa8de344><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-aa8de344><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-aa8de344><div class="VPMenu" data-v-aa8de344 data-v-e42ed9b3><!----><!--[--><!--[--><!----><div class="group" data-v-c8c2ae4b><div class="item appearance" data-v-c8c2ae4b><p class="label" data-v-c8c2ae4b>Appearance</p><div class="appearance-action" data-v-c8c2ae4b><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-c8c2ae4b data-v-3329432d data-v-1c29e291><span class="check" data-v-1c29e291><span class="icon" data-v-1c29e291><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-3329432d><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-3329432d><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-c8c2ae4b><div class="item social-links" data-v-c8c2ae4b><div class="VPSocialLinks social-links-list" data-v-c8c2ae4b data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/immense/immybot-documentation" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-16cf740a><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-f1abbc6e data-v-6bee1efd><span class="container" data-v-6bee1efd><span class="top" data-v-6bee1efd></span><span class="middle" data-v-6bee1efd></span><span class="bottom" data-v-6bee1efd></span></span></button></div></div></div></div><!----></header><div class="VPLocalNav reached-top" data-v-4064354f data-v-9e669cc1><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-9e669cc1><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-9e669cc1><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-9e669cc1>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-9e669cc1 data-v-24251f6f><button data-v-24251f6f>Return to top</button><!----></div></div><aside class="VPSidebar" data-v-4064354f data-v-ee2efba5><div class="curtain" data-v-ee2efba5></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-ee2efba5><span class="visually-hidden" id="sidebar-aria-label" data-v-ee2efba5> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-ee2efba5><section class="VPSidebarItem level-0 collapsible" data-v-ee2efba5 data-v-bd01e0d5><div class="item" role="button" tabindex="0" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><h2 class="text" data-v-bd01e0d5>Introduction</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-bd01e0d5><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-bd01e0d5><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-bd01e0d5><!--[--><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/getting-started.html" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Getting Started</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/releases.html" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>What's New</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="./add-users.html" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Add Users</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="./onboarding.html" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Onboarding</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="./recommended-deployments.html" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Recommended Deployments</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="./terminology.html" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Terminology</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="./troubleshooting.html" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Troubleshooting</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="./user-roles.html" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>User Roles</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="./windows-sandbox.html" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Windows Sandbox</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-ee2efba5><section class="VPSidebarItem level-0 collapsible" data-v-ee2efba5 data-v-bd01e0d5><div class="item" role="button" tabindex="0" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><h2 class="text" data-v-bd01e0d5>Integrations</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-bd01e0d5><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-bd01e0d5><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-bd01e0d5><!--[--><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/build-your-own-integration.html" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Build Your Own</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/connectwise-automate-integration-setup.html" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>ConnectWise Automate</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/connectwise-control-integration-setup.html" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>ConnectWise Control</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/connectwise-manage-integration-setup.html" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>ConnectWise Manage</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/ncentral-integration-setup.html" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>N-Central</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/halo-integration-setup.html" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>HaloPSA</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/azure-graph-permissions-setup.html" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Azure</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-ee2efba5><section class="VPSidebarItem level-0 collapsible has-active" data-v-ee2efba5 data-v-bd01e0d5><div class="item" role="button" tabindex="0" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><h2 class="text" data-v-bd01e0d5>Advanced</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-bd01e0d5><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-bd01e0d5><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-bd01e0d5><!--[--><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/scripts.html" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Scripting Guide</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/immy-commands.html" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Metascripts / Cloud Scripts</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-ee2efba5><section class="VPSidebarItem level-0" data-v-ee2efba5 data-v-bd01e0d5><!----><div class="items" data-v-bd01e0d5><!--[--><div class="VPSidebarItem level-1 is-link" data-v-bd01e0d5 data-v-bd01e0d5><div class="item" data-v-bd01e0d5><div class="indicator" data-v-bd01e0d5></div><a class="VPLink link link" href="/FAQ.html" data-v-bd01e0d5><!--[--><p class="text" data-v-bd01e0d5>Frequently Asked Questions</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-4064354f data-v-3cf691b6><div class="VPDoc has-sidebar has-aside" data-v-3cf691b6 data-v-a3c25e27><!--[--><!--]--><div class="container" data-v-a3c25e27><div class="aside" data-v-a3c25e27><div class="aside-curtain" data-v-a3c25e27></div><div class="aside-container" data-v-a3c25e27><div class="aside-content" data-v-a3c25e27><div class="VPDocAside" data-v-a3c25e27 data-v-cb998dce><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" role="navigation" data-v-cb998dce data-v-3a6c4994><div class="content" data-v-3a6c4994><div class="outline-marker" data-v-3a6c4994></div><div class="outline-title" role="heading" aria-level="2" data-v-3a6c4994>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-3a6c4994><span class="visually-hidden" id="doc-outline-aria-label" data-v-3a6c4994> Table of Contents for current page </span><ul class="root" data-v-3a6c4994 data-v-463da30f><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-cb998dce></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-a3c25e27><div class="content-container" data-v-a3c25e27><!--[--><!--]--><!----><main class="main" data-v-a3c25e27><div style="position:relative;" class="vp-doc _immy-commands" data-v-a3c25e27><div><h1 id="metascripts-cloud-scripts" tabindex="-1">Metascripts / Cloud Scripts <a class="header-anchor" href="#metascripts-cloud-scripts" aria-label="Permalink to &quot;Metascripts / Cloud Scripts&quot;">​</a></h1><p>A Metascript is a script that runs scripts. These scripts run in the backend of ImmyBot.</p><p>A Metascript can run a script on a computer using Invoke-ImmyCommand.</p><h2 id="example" tabindex="-1">Example <a class="header-anchor" href="#example" aria-label="Permalink to &quot;Example&quot;">​</a></h2><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">$ServerPSVersionTable </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">$PSVersionTable</span></span>
<span class="line"><span style="color:#E1E4E8;">$ComputerPSVersionTable </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Invoke-ImmyCommand</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    $ServerPSVersionTable </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> $</span><span style="color:#F97583;">using</span><span style="color:#E1E4E8;">:ServerPSVersionTable</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">Write-Host</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Running from </span><span style="color:#E1E4E8;">$</span><span style="color:#79B8FF;">env:</span><span style="color:#E1E4E8;">ComputerName</span><span style="color:#9ECBFF;"> but ImmyBot backend is running PowerShell </span><span style="color:#F97583;">$</span><span style="color:#9ECBFF;">(</span><span style="color:#E1E4E8;">$ServerPSVersionTable.PSVersion</span><span style="color:#9ECBFF;">)</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">ForegroundColor Green</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">$PSVersionTable</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"><span style="color:#79B8FF;">$VerbosePreference</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;Continue&#39;</span></span>
<span class="line"><span style="color:#79B8FF;">Write-Verbose</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Running from ImmyBot backend, but the computer is running Windows PowerShell </span><span style="color:#F97583;">$</span><span style="color:#9ECBFF;">(</span><span style="color:#E1E4E8;">$ComputerPSVersionTable.PSVersion</span><span style="color:#9ECBFF;">)</span><span style="color:#9ECBFF;">&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">$ServerPSVersionTable </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">$PSVersionTable</span></span>
<span class="line"><span style="color:#24292E;">$ComputerPSVersionTable </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Invoke-ImmyCommand</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    $ServerPSVersionTable </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $</span><span style="color:#D73A49;">using</span><span style="color:#24292E;">:ServerPSVersionTable</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">Write-Host</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Running from </span><span style="color:#24292E;">$</span><span style="color:#005CC5;">env:</span><span style="color:#24292E;">ComputerName</span><span style="color:#032F62;"> but ImmyBot backend is running PowerShell </span><span style="color:#D73A49;">$</span><span style="color:#032F62;">(</span><span style="color:#24292E;">$ServerPSVersionTable.PSVersion</span><span style="color:#032F62;">)</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">ForegroundColor Green</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">$PSVersionTable</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#005CC5;">$VerbosePreference</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;Continue&#39;</span></span>
<span class="line"><span style="color:#005CC5;">Write-Verbose</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Running from ImmyBot backend, but the computer is running Windows PowerShell </span><span style="color:#D73A49;">$</span><span style="color:#032F62;">(</span><span style="color:#24292E;">$ComputerPSVersionTable.PSVersion</span><span style="color:#032F62;">)</span><span style="color:#032F62;">&quot;</span></span></code></pre></div><h2 id="output" tabindex="-1">Output <a class="header-anchor" href="#output" aria-label="Permalink to &quot;Output&quot;">​</a></h2><p><img src="https://user-images.githubusercontent.com/1424395/186782839-81293dbb-8206-4dbb-be78-f94efbfbbacf.png" alt="image"></p><p>Invoke-ImmyCommand is modelled after PowerShell&#39;s native Invoke-Command, up to and including the ability to pass real objects into and out of the remote runspace, while preserving stream information. We consider our approach superior to capturing standard output and standard error as a string like most automation tools.</p><p>Metascripts allow you to do things like persist reboots since the context is held by the backend.</p><h2 id="cloud-scripts" tabindex="-1">Cloud Scripts <a class="header-anchor" href="#cloud-scripts" aria-label="Permalink to &quot;Cloud Scripts&quot;">​</a></h2><p>A Cloud script is the same as a Metascript except it targets a Tenant instead of a specific computer. This is useful for manipulating settings in each customer&#39;s Azure environment.</p><p>Collectively we refer to Metascripts and Cloud scripts as server-side scripts.</p><h2 id="common-commands" tabindex="-1">Common Commands <a class="header-anchor" href="#common-commands" aria-label="Permalink to &quot;Common Commands&quot;">​</a></h2><p>These commands are available in all server-side scripts.</p><h3 id="connect-immyazuread" tabindex="-1">Connect-ImmyAzureAD <a class="header-anchor" href="#connect-immyazuread" aria-label="Permalink to &quot;Connect-ImmyAzureAD&quot;">​</a></h3><p>Provides a wrapper around <code>Connect-AzureAD</code></p><ul><li><a href="https://docs.microsoft.com/en-us/powershell/module/azuread/connect-azuread?view=azureadps-2.0" target="_blank" rel="noreferrer">https://docs.microsoft.com/en-us/powershell/module/azuread/connect-azuread?view=azureadps-2.0</a></li></ul><h4 id="example-1" tabindex="-1">Example <a class="header-anchor" href="#example-1" aria-label="Permalink to &quot;Example&quot;">​</a></h4><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">Connect-ImmyAzureAD</span><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#79B8FF;">Get-AzureADUser</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">All </span><span style="color:#79B8FF;">$true</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">Connect-ImmyAzureAD</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#005CC5;">Get-AzureADUser</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">All </span><span style="color:#005CC5;">$true</span></span></code></pre></div><h3 id="get-immyazureauthheader" tabindex="-1">Get-ImmyAzureAuthHeader <a class="header-anchor" href="#get-immyazureauthheader" aria-label="Permalink to &quot;Get-ImmyAzureAuthHeader&quot;">​</a></h3><p>Obtains an auth header for the specified endpoint</p><h4 id="usage" tabindex="-1">Usage <a class="header-anchor" href="#usage" aria-label="Permalink to &quot;Usage&quot;">​</a></h4><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">Get-ImmyAzureAuthHeader</span><span style="color:#E1E4E8;"> [</span><span style="color:#F97583;">-Endpoint</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;">[</span><span style="color:#9ECBFF;">&quot;MSGraph&quot;</span><span style="color:#F97583;">,</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;AzureAD&quot;</span><span style="color:#E1E4E8;">]</span><span style="color:#F97583;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">Get-ImmyAzureAuthHeader</span><span style="color:#24292E;"> [</span><span style="color:#D73A49;">-Endpoint</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">[</span><span style="color:#032F62;">&quot;MSGraph&quot;</span><span style="color:#D73A49;">,</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;AzureAD&quot;</span><span style="color:#24292E;">]</span><span style="color:#D73A49;">&gt;</span></span></code></pre></div><p>Returns a <code>[dictionary]</code> containing the auth header</p><h4 id="examples" tabindex="-1">Examples <a class="header-anchor" href="#examples" aria-label="Permalink to &quot;Examples&quot;">​</a></h4><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">$Header </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Get-ImmyAzureAuthHeader</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">ErrorAction Stop</span></span>
<span class="line"><span style="color:#E1E4E8;">$Groups </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Invoke-RestMethod</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;https://graph.microsoft.com/v1.0/groups/</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">$Header </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Get-ImmyAzureAuthHeader</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">ErrorAction Stop</span></span>
<span class="line"><span style="color:#24292E;">$Groups </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Invoke-RestMethod</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;https://graph.microsoft.com/v1.0/groups/</span></span></code></pre></div><h3 id="get-providerinfo" tabindex="-1">Get-ProviderInfo <a class="header-anchor" href="#get-providerinfo" aria-label="Permalink to &quot;Get-ProviderInfo&quot;">​</a></h3><p>Retrieves an instance of an RMM Provider for the specified type.</p><h4 id="alias" tabindex="-1">Alias <a class="header-anchor" href="#alias" aria-label="Permalink to &quot;Alias&quot;">​</a></h4><p>Get-RmmInfo</p><h4 id="usage-1" tabindex="-1">Usage <a class="header-anchor" href="#usage-1" aria-label="Permalink to &quot;Usage&quot;">​</a></h4><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">Get-ProviderInfo</span><span style="color:#E1E4E8;"> [[</span><span style="color:#F97583;">-ProviderType</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">&lt;string&gt;</span><span style="color:#E1E4E8;">] [</span><span style="color:#F97583;">-IncludeClients</span><span style="color:#E1E4E8;">] [</span><span style="color:#F97583;">&lt;CommonParameters&gt;</span><span style="color:#E1E4E8;">]</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">Get-ProviderInfo</span><span style="color:#24292E;"> [[</span><span style="color:#D73A49;">-ProviderType</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">&lt;string&gt;</span><span style="color:#24292E;">] [</span><span style="color:#D73A49;">-IncludeClients</span><span style="color:#24292E;">] [</span><span style="color:#D73A49;">&lt;CommonParameters&gt;</span><span style="color:#24292E;">]</span></span></code></pre></div><h4 id="examples-1" tabindex="-1">Examples <a class="header-anchor" href="#examples-1" aria-label="Permalink to &quot;Examples&quot;">​</a></h4><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">param</span><span style="color:#E1E4E8;">(</span></span>
<span class="line"><span style="color:#E1E4E8;">    [</span><span style="color:#F97583;">string</span><span style="color:#E1E4E8;">]$FieldName</span><span style="color:#F97583;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    [</span><span style="color:#F97583;">string</span><span style="color:#E1E4E8;">]$Value</span><span style="color:#F97583;">,</span></span>
<span class="line"><span style="color:#E1E4E8;">    $Computer</span></span>
<span class="line"><span style="color:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">if</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">!</span><span style="color:#E1E4E8;">$Computer)</span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    $Computer </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Get-ImmyComputer</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"><span style="color:#E1E4E8;">$RmmComputer </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Get-RmmComputer</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Computer $Computer </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">ProviderType CWAutomate</span></span>
<span class="line"><span style="color:#E1E4E8;">$RmmInfo </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Get-ProviderInfo</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">ProviderType CWAutomate</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">$EDF </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Get-CWAComputerEDF</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">FieldName $FieldName </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Computer $Computer</span></span>
<span class="line"><span style="color:#F97583;">if</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">!</span><span style="color:#E1E4E8;">$EDF)</span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">Write-Warning</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Aborting: Unable to find EDF </span><span style="color:#E1E4E8;">$FieldName</span><span style="color:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">$ExtraFieldDefinitionId </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> $EDF.ExtraFieldDefinitionId</span></span>
<span class="line"><span style="color:#E1E4E8;">$ValueProperty </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> $EDF </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> select </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">FieldSettings</span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Get-Member</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">MemberType NoteProperty </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> select </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">First </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">%</span><span style="color:#E1E4E8;">{</span><span style="color:#79B8FF;">$_</span><span style="color:#E1E4E8;">.Name}</span></span>
<span class="line"><span style="color:#E1E4E8;">$PatchPath </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;">$ValueProperty</span><span style="color:#9ECBFF;">/Value&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">$Uri </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;cwa/api/v1/computers/</span><span style="color:#F97583;">$</span><span style="color:#9ECBFF;">(</span><span style="color:#E1E4E8;">$RmmComputer.RmmDeviceId</span><span style="color:#9ECBFF;">)</span><span style="color:#9ECBFF;">/extrafields/</span><span style="color:#E1E4E8;">$ExtraFieldDefinitionId</span><span style="color:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">$Body </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">ConvertTo-Json</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">@</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">@</span><span style="color:#E1E4E8;">{</span><span style="color:#9ECBFF;">&quot;op&quot;</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;replace&quot;</span><span style="color:#E1E4E8;">;</span><span style="color:#9ECBFF;">&quot;path&quot;</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">$PatchPath;</span><span style="color:#9ECBFF;">&quot;value&quot;</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">$Value})</span></span>
<span class="line"><span style="color:#79B8FF;">Invoke-CWARestMethod</span><span style="color:#E1E4E8;"> $Uri </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Provider $RmmInfo.Provider </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Method PATCH </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Body $Body</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">param</span><span style="color:#24292E;">(</span></span>
<span class="line"><span style="color:#24292E;">    [</span><span style="color:#D73A49;">string</span><span style="color:#24292E;">]$FieldName</span><span style="color:#D73A49;">,</span></span>
<span class="line"><span style="color:#24292E;">    [</span><span style="color:#D73A49;">string</span><span style="color:#24292E;">]$Value</span><span style="color:#D73A49;">,</span></span>
<span class="line"><span style="color:#24292E;">    $Computer</span></span>
<span class="line"><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">if</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">!</span><span style="color:#24292E;">$Computer)</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    $Computer </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Get-ImmyComputer</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"><span style="color:#24292E;">$RmmComputer </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Get-RmmComputer</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Computer $Computer </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">ProviderType CWAutomate</span></span>
<span class="line"><span style="color:#24292E;">$RmmInfo </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Get-ProviderInfo</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">ProviderType CWAutomate</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">$EDF </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Get-CWAComputerEDF</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">FieldName $FieldName </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Computer $Computer</span></span>
<span class="line"><span style="color:#D73A49;">if</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">!</span><span style="color:#24292E;">$EDF)</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">Write-Warning</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Aborting: Unable to find EDF </span><span style="color:#24292E;">$FieldName</span><span style="color:#032F62;">&quot;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">$ExtraFieldDefinitionId </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $EDF.ExtraFieldDefinitionId</span></span>
<span class="line"><span style="color:#24292E;">$ValueProperty </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $EDF </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> select </span><span style="color:#D73A49;">*</span><span style="color:#24292E;">FieldSettings</span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Get-Member</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">MemberType NoteProperty </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> select </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">First </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">%</span><span style="color:#24292E;">{</span><span style="color:#005CC5;">$_</span><span style="color:#24292E;">.Name}</span></span>
<span class="line"><span style="color:#24292E;">$PatchPath </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">$ValueProperty</span><span style="color:#032F62;">/Value&quot;</span></span>
<span class="line"><span style="color:#24292E;">$Uri </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;cwa/api/v1/computers/</span><span style="color:#D73A49;">$</span><span style="color:#032F62;">(</span><span style="color:#24292E;">$RmmComputer.RmmDeviceId</span><span style="color:#032F62;">)</span><span style="color:#032F62;">/extrafields/</span><span style="color:#24292E;">$ExtraFieldDefinitionId</span><span style="color:#032F62;">&quot;</span></span>
<span class="line"><span style="color:#24292E;">$Body </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">ConvertTo-Json</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">@</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">@</span><span style="color:#24292E;">{</span><span style="color:#032F62;">&quot;op&quot;</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;replace&quot;</span><span style="color:#24292E;">;</span><span style="color:#032F62;">&quot;path&quot;</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">$PatchPath;</span><span style="color:#032F62;">&quot;value&quot;</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">$Value})</span></span>
<span class="line"><span style="color:#005CC5;">Invoke-CWARestMethod</span><span style="color:#24292E;"> $Uri </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Provider $RmmInfo.Provider </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Method PATCH </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Body $Body</span></span></code></pre></div><h2 id="metascript-commands" tabindex="-1">Metascript Commands <a class="header-anchor" href="#metascript-commands" aria-label="Permalink to &quot;Metascript Commands&quot;">​</a></h2><h3 id="invoke-immycommand" tabindex="-1">Invoke-ImmyCommand <a class="header-anchor" href="#invoke-immycommand" aria-label="Permalink to &quot;Invoke-ImmyCommand&quot;">​</a></h3><p>A powerful command that allows you to execute scripts remotely on devices.</p><h4 id="usage-2" tabindex="-1">Usage <a class="header-anchor" href="#usage-2" aria-label="Permalink to &quot;Usage&quot;">​</a></h4><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">Invoke-ImmyCommand</span><span style="color:#E1E4E8;"> [</span><span style="color:#F97583;">-ScriptBlock</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;">Object</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> [</span><span style="color:#F97583;">-Computer</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;PSComputer&gt;</span><span style="color:#E1E4E8;">] [</span><span style="color:#F97583;">-Context</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;string&gt;</span><span style="color:#E1E4E8;">] [</span><span style="color:#F97583;">-ArgumentList</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;array&gt;</span><span style="color:#E1E4E8;">] [</span><span style="color:#F97583;">-Timeout</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;int&gt;</span><span style="color:#E1E4E8;">] [</span><span style="color:#F97583;">-ConnectTimeout</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;int&gt;</span><span style="color:#E1E4E8;">] [</span><span style="color:#F97583;">-DisableConnectTimeoutWarnings</span><span style="color:#E1E4E8;">] [</span><span style="color:#F97583;">-Parallel</span><span style="color:#E1E4E8;">] [</span><span style="color:#F97583;">&lt;CommonParameters&gt;</span><span style="color:#E1E4E8;">]</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">Invoke-ImmyCommand</span><span style="color:#24292E;"> [</span><span style="color:#D73A49;">-ScriptBlock</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">Object</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> [</span><span style="color:#D73A49;">-Computer</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;PSComputer&gt;</span><span style="color:#24292E;">] [</span><span style="color:#D73A49;">-Context</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;string&gt;</span><span style="color:#24292E;">] [</span><span style="color:#D73A49;">-ArgumentList</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;array&gt;</span><span style="color:#24292E;">] [</span><span style="color:#D73A49;">-Timeout</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;int&gt;</span><span style="color:#24292E;">] [</span><span style="color:#D73A49;">-ConnectTimeout</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;int&gt;</span><span style="color:#24292E;">] [</span><span style="color:#D73A49;">-DisableConnectTimeoutWarnings</span><span style="color:#24292E;">] [</span><span style="color:#D73A49;">-Parallel</span><span style="color:#24292E;">] [</span><span style="color:#D73A49;">&lt;CommonParameters&gt;</span><span style="color:#24292E;">]</span></span></code></pre></div><p><code>-Context</code> accepts either &quot;System&quot; or &quot;User&quot;</p><p><code>-Timeout</code> accepts an integer denoted in seconds. The default is 120.</p><p><code>-Parallel</code> (switch, makes the script block run on all the computers simultaneously instead of in series)</p><p><code>-ConnectTimeout</code> (integer, seconds, to override the amount of time before giving up on trying to start the script on a computer)</p><p><code>-DisableConnectTimeoutWarnings</code> (switch, to suppress &quot;WARNING: Timed out waiting for script to start on COMPUTER&quot; for every computer that fails to start within the connect timeout).</p><h4 id="examples-2" tabindex="-1">Examples <a class="header-anchor" href="#examples-2" aria-label="Permalink to &quot;Examples&quot;">​</a></h4><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">&lt;# Execute a metascript against the primary computer #&gt;</span></span>
<span class="line"><span style="color:#79B8FF;">Invoke-ImmyCommand</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">&lt;# add powershell to run on the comptuer #&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">write-output</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;hello&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">&lt;# Execute a metascript against the primary computer #&gt;</span></span>
<span class="line"><span style="color:#005CC5;">Invoke-ImmyCommand</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">&lt;# add powershell to run on the comptuer #&gt;</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">write-output</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;hello&quot;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">&lt;# Retrieve a list of computers and run a command on all of them #&gt;</span></span>
<span class="line"><span style="color:#79B8FF;">Get-ImmyComputer</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">TargetGroupFilter All </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Invoke-ImmyCommand</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">Write-Output</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Hello&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">&lt;# Retrieve a list of computers and run a command on all of them #&gt;</span></span>
<span class="line"><span style="color:#005CC5;">Get-ImmyComputer</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">TargetGroupFilter All </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Invoke-ImmyCommand</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">Write-Output</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Hello&quot;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div><h3 id="send-immyemail" tabindex="-1">Send-ImmyEmail <a class="header-anchor" href="#send-immyemail" aria-label="Permalink to &quot;Send-ImmyEmail&quot;">​</a></h3><p>Sends an Immybot styled email. If no <code>To</code> is provided, then the email will be sent using the same logic for sending the detection emails during a maintenance session.</p><h4 id="usage-3" tabindex="-1">Usage <a class="header-anchor" href="#usage-3" aria-label="Permalink to &quot;Usage&quot;">​</a></h4><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">Send-ImmyEmail</span><span style="color:#E1E4E8;"> [</span><span style="color:#F97583;">-Subject</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;">string</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> [</span><span style="color:#F97583;">-Body</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;">string</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> [[</span><span style="color:#F97583;">-To</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">&lt;List</span><span style="color:#E1E4E8;">[</span><span style="color:#F97583;">string</span><span style="color:#E1E4E8;">]</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;">] [[</span><span style="color:#F97583;">-Bcc</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">&lt;List</span><span style="color:#E1E4E8;">[</span><span style="color:#F97583;">string</span><span style="color:#E1E4E8;">]</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;">]</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">Send-ImmyEmail</span><span style="color:#24292E;"> [</span><span style="color:#D73A49;">-Subject</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">string</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> [</span><span style="color:#D73A49;">-Body</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">string</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> [[</span><span style="color:#D73A49;">-To</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">&lt;List</span><span style="color:#24292E;">[</span><span style="color:#D73A49;">string</span><span style="color:#24292E;">]</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;">] [[</span><span style="color:#D73A49;">-Bcc</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">&lt;List</span><span style="color:#24292E;">[</span><span style="color:#D73A49;">string</span><span style="color:#24292E;">]</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;">]</span></span></code></pre></div><h4 id="examples-3" tabindex="-1">Examples <a class="header-anchor" href="#examples-3" aria-label="Permalink to &quot;Examples&quot;">​</a></h4><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">&lt;# Sends an email using the same logic used in sending detection emails out during maintenance. #&gt;</span></span>
<span class="line"><span style="color:#79B8FF;">Send-ImmyEmail</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Subject </span><span style="color:#9ECBFF;">&quot;Test&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Body </span><span style="color:#9ECBFF;">&quot;Some Body&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">&lt;# Sends an email using the same logic used in sending detection emails out during maintenance. #&gt;</span></span>
<span class="line"><span style="color:#005CC5;">Send-ImmyEmail</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Subject </span><span style="color:#032F62;">&quot;Test&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Body </span><span style="color:#032F62;">&quot;Some Body&quot;</span></span></code></pre></div><h3 id="refresh-computersysteminfo" tabindex="-1">Refresh-ComputerSystemInfo <a class="header-anchor" href="#refresh-computersysteminfo" aria-label="Permalink to &quot;Refresh-ComputerSystemInfo&quot;">​</a></h3><h4 id="usage-4" tabindex="-1">Usage <a class="header-anchor" href="#usage-4" aria-label="Permalink to &quot;Usage&quot;">​</a></h4><p>This command will run an inventory command to refresh the following computer information:</p><ul><li>ComputerName</li><li>SerialNumber</li><li>ChassisTypes</li><li>DomainRole</li><li>Domain</li><li>OsName</li><li>OsInstallDate</li><li>LastBootTime</li><li>Model</li><li>Manufacturer</li></ul><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">Refresh</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">ComputerSystemInfo [[</span><span style="color:#F97583;">-Computer</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">&lt;PSComputer&gt;</span><span style="color:#E1E4E8;">]</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">Refresh</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">ComputerSystemInfo [[</span><span style="color:#D73A49;">-Computer</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">&lt;PSComputer&gt;</span><span style="color:#24292E;">]</span></span></code></pre></div><h4 id="examples-4" tabindex="-1">Examples <a class="header-anchor" href="#examples-4" aria-label="Permalink to &quot;Examples&quot;">​</a></h4><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">&lt;# If you do not supply the Computer parameter, then it will default to using the computer for the current session #&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">Refresh</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">ComputerSystemInfo</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">&lt;# If you do not supply the Computer parameter, then it will default to using the computer for the current session #&gt;</span></span>
<span class="line"><span style="color:#24292E;">Refresh</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">ComputerSystemInfo</span></span></code></pre></div><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">&lt;# This will refresh the computer system info for all servers. #&gt;</span></span>
<span class="line"><span style="color:#79B8FF;">Get-ImmyComputer</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">TargetGroupFilter Servers </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> Refresh</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">ComputerSystemInfo</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">&lt;# This will refresh the computer system info for all servers. #&gt;</span></span>
<span class="line"><span style="color:#005CC5;">Get-ImmyComputer</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">TargetGroupFilter Servers </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> Refresh</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">ComputerSystemInfo</span></span></code></pre></div><h3 id="get-rmmcomputer" tabindex="-1">Get-RmmComputer <a class="header-anchor" href="#get-rmmcomputer" aria-label="Permalink to &quot;Get-RmmComputer&quot;">​</a></h3><p>Coming Soon</p><h3 id="get-immycomputer" tabindex="-1">Get-ImmyComputer <a class="header-anchor" href="#get-immycomputer" aria-label="Permalink to &quot;Get-ImmyComputer&quot;">​</a></h3><p>Coming Soon</p><h2 id="filterscript-commands" tabindex="-1">Filterscript Commands <a class="header-anchor" href="#filterscript-commands" aria-label="Permalink to &quot;Filterscript Commands&quot;">​</a></h2><h3 id="get-immycomputer-1" tabindex="-1">Get-ImmyComputer <a class="header-anchor" href="#get-immycomputer-1" aria-label="Permalink to &quot;Get-ImmyComputer&quot;">​</a></h3><p>Returns a list of computers for the specified tenant, or all computers if it is cross tenant scoped.</p><h4 id="usage-5" tabindex="-1">Usage <a class="header-anchor" href="#usage-5" aria-label="Permalink to &quot;Usage&quot;">​</a></h4><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">Get-ImmyComputer</span><span style="color:#E1E4E8;"> [</span><span style="color:#F97583;">-InventoryKeys</span><span style="color:#E1E4E8;">] </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;">string[]</span><span style="color:#F97583;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">Get-ImmyComputer</span><span style="color:#24292E;"> [</span><span style="color:#D73A49;">-InventoryKeys</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">string[]</span><span style="color:#D73A49;">&gt;</span></span></code></pre></div><h4 id="examples-5" tabindex="-1">Examples <a class="header-anchor" href="#examples-5" aria-label="Permalink to &quot;Examples&quot;">​</a></h4><p>Coming soon</p><h2 id="software-auto-update-commands" tabindex="-1">Software Auto Update Commands <a class="header-anchor" href="#software-auto-update-commands" aria-label="Permalink to &quot;Software Auto Update Commands&quot;">​</a></h2><h3 id="add-script" tabindex="-1">Add-Script <a class="header-anchor" href="#add-script" aria-label="Permalink to &quot;Add-Script&quot;">​</a></h3><p>Coming Soon</p><h3 id="get-script" tabindex="-1">Get-Script <a class="header-anchor" href="#get-script" aria-label="Permalink to &quot;Get-Script&quot;">​</a></h3><p>Coming Soon</p><h3 id="add-softwareversion" tabindex="-1">Add-SoftwareVersion <a class="header-anchor" href="#add-softwareversion" aria-label="Permalink to &quot;Add-SoftwareVersion&quot;">​</a></h3><h4 id="usage-6" tabindex="-1">Usage <a class="header-anchor" href="#usage-6" aria-label="Permalink to &quot;Usage&quot;">​</a></h4><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">Add-SoftwareVersion</span><span style="color:#E1E4E8;"> [</span><span style="color:#F97583;">-SoftwareVersion</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;SoftwareVersion&gt;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">  [</span><span style="color:#F97583;">-SoftwareType</span><span style="color:#E1E4E8;"> {GlobalSoftware </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> LocalSoftware </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> WindowsUpdate </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> Chocolatey </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> Ninite}]</span></span>
<span class="line"><span style="color:#E1E4E8;">  [</span><span style="color:#F97583;">-DisplayName</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;string&gt;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">  [</span><span style="color:#F97583;">-SemanticVersion</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;string&gt;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">  [</span><span style="color:#F97583;">-TestRequired</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;bool&gt;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">  [</span><span style="color:#F97583;">-Url</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;string&gt;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">  [</span><span style="color:#F97583;">-RelativeCacheSourcePath</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;string&gt;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">  [</span><span style="color:#F97583;">-InstallerFile</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;string&gt;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">  [</span><span style="color:#F97583;">-PackageHash</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;string&gt;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">  [</span><span style="color:#F97583;">-TestFailedError</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;string&gt;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">  [</span><span style="color:#F97583;">-InstallScriptId</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;int&gt;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">  [</span><span style="color:#F97583;">-InstallScriptType</span><span style="color:#E1E4E8;"> {Global </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> Local}]</span></span>
<span class="line"><span style="color:#E1E4E8;">  [</span><span style="color:#F97583;">-TestScriptId</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;int&gt;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">  [</span><span style="color:#F97583;">-TestScriptType</span><span style="color:#E1E4E8;"> {Global </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> Local}]</span></span>
<span class="line"><span style="color:#E1E4E8;">  [</span><span style="color:#F97583;">-UpgradeScriptId</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;int&gt;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">  [</span><span style="color:#F97583;">-UpgradeScriptType</span><span style="color:#E1E4E8;"> {Global </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> Local}]</span></span>
<span class="line"><span style="color:#E1E4E8;">  [</span><span style="color:#F97583;">-UninstallScriptId</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;int&gt;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">  [</span><span style="color:#F97583;">-UninstallScriptType</span><span style="color:#E1E4E8;"> {Global </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> Local}]</span></span>
<span class="line"><span style="color:#E1E4E8;">  [</span><span style="color:#F97583;">-PostInstallScriptId</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;int&gt;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">  [</span><span style="color:#F97583;">-PostInstallScriptType</span><span style="color:#E1E4E8;"> {Global </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> Local}]</span></span>
<span class="line"><span style="color:#E1E4E8;">  [</span><span style="color:#F97583;">-PostUninstallScriptId</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;int&gt;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">  [</span><span style="color:#F97583;">-PostUninstallScriptType</span><span style="color:#E1E4E8;"> {Global </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> Local}]</span></span>
<span class="line"><span style="color:#E1E4E8;">  [</span><span style="color:#F97583;">-LicenseType</span><span style="color:#E1E4E8;"> {None </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> LicenseFile </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> Key}]</span></span>
<span class="line"><span style="color:#E1E4E8;">  [</span><span style="color:#F97583;">-UpgradeStrategy</span><span style="color:#E1E4E8;"> {None </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> UninstallInstall </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> InstallOver </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> UpgradeScript}]</span></span>
<span class="line"><span style="color:#E1E4E8;">  [</span><span style="color:#F97583;">-PackageType</span><span style="color:#E1E4E8;"> {None </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> EntireFolder </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> InstallerFile}]</span></span>
<span class="line"><span style="color:#E1E4E8;">  [</span><span style="color:#F97583;">-InstallerType</span><span style="color:#E1E4E8;"> {None </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> File </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> Url}]</span></span>
<span class="line"><span style="color:#E1E4E8;">  [</span><span style="color:#F97583;">-BlobName</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;string&gt;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">  [</span><span style="color:#F97583;">-Notes</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;string&gt;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">  [</span><span style="color:#F97583;">-ProductCode</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;string&gt;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">  [</span><span style="color:#F97583;">&lt;CommonParameters&gt;</span><span style="color:#E1E4E8;">]</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">Add-SoftwareVersion</span><span style="color:#24292E;"> [</span><span style="color:#D73A49;">-SoftwareVersion</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;SoftwareVersion&gt;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">  [</span><span style="color:#D73A49;">-SoftwareType</span><span style="color:#24292E;"> {GlobalSoftware </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> LocalSoftware </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> WindowsUpdate </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> Chocolatey </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> Ninite}]</span></span>
<span class="line"><span style="color:#24292E;">  [</span><span style="color:#D73A49;">-DisplayName</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;string&gt;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">  [</span><span style="color:#D73A49;">-SemanticVersion</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;string&gt;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">  [</span><span style="color:#D73A49;">-TestRequired</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;bool&gt;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">  [</span><span style="color:#D73A49;">-Url</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;string&gt;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">  [</span><span style="color:#D73A49;">-RelativeCacheSourcePath</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;string&gt;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">  [</span><span style="color:#D73A49;">-InstallerFile</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;string&gt;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">  [</span><span style="color:#D73A49;">-PackageHash</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;string&gt;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">  [</span><span style="color:#D73A49;">-TestFailedError</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;string&gt;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">  [</span><span style="color:#D73A49;">-InstallScriptId</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;int&gt;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">  [</span><span style="color:#D73A49;">-InstallScriptType</span><span style="color:#24292E;"> {Global </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> Local}]</span></span>
<span class="line"><span style="color:#24292E;">  [</span><span style="color:#D73A49;">-TestScriptId</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;int&gt;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">  [</span><span style="color:#D73A49;">-TestScriptType</span><span style="color:#24292E;"> {Global </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> Local}]</span></span>
<span class="line"><span style="color:#24292E;">  [</span><span style="color:#D73A49;">-UpgradeScriptId</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;int&gt;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">  [</span><span style="color:#D73A49;">-UpgradeScriptType</span><span style="color:#24292E;"> {Global </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> Local}]</span></span>
<span class="line"><span style="color:#24292E;">  [</span><span style="color:#D73A49;">-UninstallScriptId</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;int&gt;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">  [</span><span style="color:#D73A49;">-UninstallScriptType</span><span style="color:#24292E;"> {Global </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> Local}]</span></span>
<span class="line"><span style="color:#24292E;">  [</span><span style="color:#D73A49;">-PostInstallScriptId</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;int&gt;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">  [</span><span style="color:#D73A49;">-PostInstallScriptType</span><span style="color:#24292E;"> {Global </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> Local}]</span></span>
<span class="line"><span style="color:#24292E;">  [</span><span style="color:#D73A49;">-PostUninstallScriptId</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;int&gt;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">  [</span><span style="color:#D73A49;">-PostUninstallScriptType</span><span style="color:#24292E;"> {Global </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> Local}]</span></span>
<span class="line"><span style="color:#24292E;">  [</span><span style="color:#D73A49;">-LicenseType</span><span style="color:#24292E;"> {None </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> LicenseFile </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> Key}]</span></span>
<span class="line"><span style="color:#24292E;">  [</span><span style="color:#D73A49;">-UpgradeStrategy</span><span style="color:#24292E;"> {None </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> UninstallInstall </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> InstallOver </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> UpgradeScript}]</span></span>
<span class="line"><span style="color:#24292E;">  [</span><span style="color:#D73A49;">-PackageType</span><span style="color:#24292E;"> {None </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> EntireFolder </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> InstallerFile}]</span></span>
<span class="line"><span style="color:#24292E;">  [</span><span style="color:#D73A49;">-InstallerType</span><span style="color:#24292E;"> {None </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> File </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> Url}]</span></span>
<span class="line"><span style="color:#24292E;">  [</span><span style="color:#D73A49;">-BlobName</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;string&gt;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">  [</span><span style="color:#D73A49;">-Notes</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;string&gt;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">  [</span><span style="color:#D73A49;">-ProductCode</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;string&gt;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">  [</span><span style="color:#D73A49;">&lt;CommonParameters&gt;</span><span style="color:#24292E;">]</span></span></code></pre></div><h4 id="examples-6" tabindex="-1">Examples <a class="header-anchor" href="#examples-6" aria-label="Permalink to &quot;Examples&quot;">​</a></h4><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">$download_page </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Invoke-WebRequest</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Uri </span><span style="color:#9ECBFF;">&#39;https://github.com/dbeaver/dbeaver/releases/latest&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">UseBasicParsing</span></span>
<span class="line"><span style="color:#E1E4E8;">$url </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> $download_page.links </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">?</span><span style="color:#E1E4E8;"> href </span><span style="color:#F97583;">-match</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;\.exe$&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> select </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Expand href </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">First </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">%</span><span style="color:#E1E4E8;"> { </span><span style="color:#9ECBFF;">&#39;https://github.com&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">$_</span><span style="color:#E1E4E8;"> }</span></span>
<span class="line"><span style="color:#E1E4E8;">$versionString </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> $url </span><span style="color:#F97583;">-split</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;/&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> select </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Last </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Skip </span><span style="color:#79B8FF;">1</span></span>
<span class="line"><span style="color:#E1E4E8;">$latestVersion </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> $SoftwareVersions </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> sort SemanticVersion </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> select </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">last </span><span style="color:#79B8FF;">1</span></span>
<span class="line"><span style="color:#E1E4E8;">$createdVersion </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">Add-SoftwareVersion</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">SoftwareVersion $latestVersion </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">SemanticVersion  $versionString </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">Url $url</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">$download_page </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Invoke-WebRequest</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Uri </span><span style="color:#032F62;">&#39;https://github.com/dbeaver/dbeaver/releases/latest&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">UseBasicParsing</span></span>
<span class="line"><span style="color:#24292E;">$url </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $download_page.links </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">?</span><span style="color:#24292E;"> href </span><span style="color:#D73A49;">-match</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;\.exe$&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> select </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Expand href </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">First </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">%</span><span style="color:#24292E;"> { </span><span style="color:#032F62;">&#39;https://github.com&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">$_</span><span style="color:#24292E;"> }</span></span>
<span class="line"><span style="color:#24292E;">$versionString </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $url </span><span style="color:#D73A49;">-split</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;/&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> select </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Last </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Skip </span><span style="color:#005CC5;">1</span></span>
<span class="line"><span style="color:#24292E;">$latestVersion </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> $SoftwareVersions </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> sort SemanticVersion </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> select </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">last </span><span style="color:#005CC5;">1</span></span>
<span class="line"><span style="color:#24292E;">$createdVersion </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">Add-SoftwareVersion</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">SoftwareVersion $latestVersion </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">SemanticVersion  $versionString </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">Url $url</span></span></code></pre></div><h3 id="get-alllocalscripts" tabindex="-1">Get-AllLocalScripts <a class="header-anchor" href="#get-alllocalscripts" aria-label="Permalink to &quot;Get-AllLocalScripts&quot;">​</a></h3><p>Coming Soon</p><h3 id="get-allglobalscripts" tabindex="-1">Get-AllGlobalScripts <a class="header-anchor" href="#get-allglobalscripts" aria-label="Permalink to &quot;Get-AllGlobalScripts&quot;">​</a></h3><p>Coming Soon</p><h2 id="cw-automate-commands" tabindex="-1">CW Automate Commands <a class="header-anchor" href="#cw-automate-commands" aria-label="Permalink to &quot;CW Automate Commands&quot;">​</a></h2><h3 id="invoke-cwaquery" tabindex="-1">Invoke-CWAQuery <a class="header-anchor" href="#invoke-cwaquery" aria-label="Permalink to &quot;Invoke-CWAQuery&quot;">​</a></h3><p>Coming Soon</p><h3 id="invoke-cwarestmethod" tabindex="-1">Invoke-CWARestMethod <a class="header-anchor" href="#invoke-cwarestmethod" aria-label="Permalink to &quot;Invoke-CWARestMethod&quot;">​</a></h3><p>Coming Soon</p><h3 id="get-cwarestpages" tabindex="-1">Get-CWARestPages <a class="header-anchor" href="#get-cwarestpages" aria-label="Permalink to &quot;Get-CWARestPages&quot;">​</a></h3><p>Coming Soon</p></div></div></main><footer class="VPDocFooter" data-v-a3c25e27 data-v-a2d931e4><!--[--><!--]--><!----><nav class="prev-next" data-v-a2d931e4><div class="pager" data-v-a2d931e4><a class="pager-link prev" href="/scripts.html" data-v-a2d931e4><span class="desc" data-v-a2d931e4>Previous page</span><span class="title" data-v-a2d931e4>Scripting Guide</span></a></div><div class="pager" data-v-a2d931e4><a class="pager-link next" href="/FAQ.html" data-v-a2d931e4><span class="desc" data-v-a2d931e4>Next page</span><span class="title" data-v-a2d931e4>Frequently Asked Questions</span></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"readme.md\":\"438fc68f\",\"connectwise-control-integration-setup.md\":\"71f4a6e4\",\"connectwise-manage-integration-setup.md\":\"1a6ece37\",\"onboarding.md\":\"aa130f5b\",\"azure-graph-permissions-setup.md\":\"3fed08cf\",\"connectwise-automate-integration-setup.md\":\"8e02436d\",\"getting-started.md\":\"77eeb39a\",\"halo-integration-setup.md\":\"88bc1610\",\"immy-commands.md\":\"3f95c339\",\"index.md\":\"f2f4a8f7\",\"faq.md\":\"439cf5cf\",\"recommended-deployments.md\":\"bf148213\",\"add-users.md\":\"f8ba72ba\",\"scripts.md\":\"7cb2a745\",\"releases-2020.md\":\"5e3302d9\",\"releases-2022.md\":\"af99a7de\",\"windows-sandbox.md\":\"420f9908\",\"terminology.md\":\"3d3e6554\",\"releases.md\":\"848b139c\",\"ncentral-integration-setup.md\":\"3ada0ca9\",\"build-your-own-integration.md\":\"b4fea51b\",\"troubleshooting.md\":\"de13605b\",\"user-roles.md\":\"83b890f7\",\"markdown-examples.md\":\"00357284\",\"releases-2021.md\":\"50e85e31\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"immy.bot\",\"description\":\"A documentation suite for all things ImmyBot\",\"base\":\"/\",\"head\":[],\"appearance\":true,\"themeConfig\":{\"logo\":\"/immybot-glasses.png\",\"sidebar\":[{\"text\":\"Introduction\",\"collapsed\":false,\"items\":[{\"text\":\"Getting Started\",\"link\":\"/getting-started\"},{\"text\":\"What's New\",\"link\":\"/releases\"},{\"text\":\"Add Users\",\"link\":\"./add-users\"},{\"text\":\"Onboarding\",\"link\":\"./onboarding\"},{\"text\":\"Recommended Deployments\",\"link\":\"./recommended-deployments\"},{\"text\":\"Terminology\",\"link\":\"./terminology\"},{\"text\":\"Troubleshooting\",\"link\":\"./troubleshooting\"},{\"text\":\"User Roles\",\"link\":\"./user-roles\"},{\"text\":\"Windows Sandbox\",\"link\":\"./windows-sandbox\"}]},{\"text\":\"Integrations\",\"collapsed\":false,\"items\":[{\"text\":\"Build Your Own\",\"link\":\"/build-your-own-integration\"},{\"text\":\"ConnectWise Automate\",\"link\":\"/connectwise-automate-integration-setup\"},{\"text\":\"ConnectWise Control\",\"link\":\"/connectwise-control-integration-setup\"},{\"text\":\"ConnectWise Manage\",\"link\":\"/connectwise-manage-integration-setup\"},{\"text\":\"N-Central\",\"link\":\"/ncentral-integration-setup\"},{\"text\":\"HaloPSA\",\"link\":\"/halo-integration-setup\"},{\"text\":\"Azure\",\"link\":\"/azure-graph-permissions-setup\"}]},{\"text\":\"Advanced\",\"collapsed\":false,\"items\":[{\"text\":\"Scripting Guide\",\"link\":\"/scripts\"},{\"text\":\"Metascripts / Cloud Scripts\",\"link\":\"/immy-commands\"}]},{\"text\":\"Frequently Asked Questions\",\"link\":\"/FAQ\"}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/immense/immybot-documentation\"}],\"search\":{\"provider\":\"algolia\",\"options\":{\"apiKey\":\"e84eee7e1fa61571b3814adfcb2a70f2\",\"indexName\":\"immy\",\"appId\":\"SU6GB55GXI\"}}},\"locales\":{},\"scrollOffset\":90,\"cleanUrls\":false}");</script>
    
  </body>
</html>